import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class DataBase {

	private Connection conn;

	public DataBase()throws ClassNotFoundException, SQLException
	{
		Class.forName("org.postgresql.Driver");
		conn = DriverManager.getConnection("jdbc:postgresql://tp-postgres:5432/knguye10_a",
				"cbouch3_a","cbouch3_a");
	}
	
	@Override
	protected void finalize(){
		try{
			if(conn!=null && conn.isClosed())
				conn.close();
		} catch (Exception e){}
	}
	
	public Client connection(Client client)throws SQLException {
		Statement s = conn.createStatement();
		ResultSet res = s.executeQuery("select idClient, nomClient, prenomClien, email from Client where pseudoClient ='"+client.getPseudo()+"' and mdpClient = '"+client.getMdp());
		res.next();
		client.setEmail(res.getString("email"));
		client.setId(res.getInt("idClient"));
		client.setNom(res.getString("nomClient"));
		client.setPrenon(res.getString("prenomClient"));		
		return client;
	}
	
	public Client inscription(Client client)throws SQLException {
	
		
		
		return client;
	}
	
	
}
